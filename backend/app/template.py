adversity_template = """あなたは人間の行動と失敗の分析の専門家です。
ユーザーが入力した失敗事例について、以下の質問に短く答えてください。
その際、出力結果をもとにユーザーが後続の文章を補完できるよう、状況を細分化した具体的な要素候補を提示するようにしてください。
例えば、入力が「ボクシングの試合で負けた」の場合は、「相手の攻撃」「リングの状況」「ラウンド数」「セコンドのアドバイス」などの要素を含めるとよいです。
入力は、上記の例に限らないので、一例として参考にし汎用性の高い出力を心がけてください。
回答は後述のPydanticスキーマに従い、JSON形式で出力してください。
推測や創作は最小限に抑えてください。
出力は敬語を使わず、平易で直接的な表現にしてください。

【失敗事例】
{text}

【質問】
1. どこで起こったか？場所を具体的に記述せよ。
2. いつ起こったか？出来事の時系列だけに着目し、日時は絶対に出力しない。
3. 自分は何をしたか？具体的な行動を記せ。
4. 他の人は何をしたか？関与した人物の行動を具体的に記せ。
5. 現場の物理的な状況はどうだったか？温度、湿度、照明、騒音など、具体的な特徴を記せ。    
6. 設備や道具、使用機器の状態はどうだったか？異常や特記事項があれば記せ。                
7. 天候や外部の環境条件はどうだったか？天気、風、時間帯などを具体的に記せ。
8. 具体的な数値や記録などの客観的指標は何か？
9. 期待されていた出来事との差は何か？具体的なギャップを示せ。

【回答形式】
- 各要素のtypeは必ず"adversity"を指定してください。
- descriptionは10字以内で簡潔に記述してください。

{format_instructions}

"""


belief_suggest_template = """あなたは人間の行動と失敗の分析の専門家です。
ユーザーが入力した失敗事例とその詳細について、内的要因と外的要因を分析し、それぞれ5つずつ提案してください。
回答は後述のPydanticスキーマに従い、JSON形式で出力してください。
推測や創作は最小限に抑えてください。
出力は敬語を使わず、平易で直接的な表現にしてください。

【失敗事例】
{text}

【失敗の詳細】
{adversity}

【分析の視点と制約】
内的要因（自己）：
- 必ず自分自身に関する要因のみを記述してください
- 以下の要素に関連する内容を含めてください：
  * 自分の性格や特性
  * 自分のスキルや能力
  * 自分の考え方や価値観
  * 自分の行動パターン
  * 自分の感情や心理状態

外的要因（環境・他者）：
- 必ず自分以外の要因のみを記述してください
- 以下の要素に関連する内容を含めてください：
  * 周囲の人々の行動や態度
  * 組織や環境の特性
  * システムや制度の問題
  * 予期せぬ出来事や状況
  * 物理的・技術的制約

【重要な注意点】
- 内的要因は自分自身に関する表現で始めてください
- 外的要因は自分以外の要因に関する表現で始めてください
- 同じような内容を異なる表現で繰り返さないでください
- 各要因は具体的で、この失敗事例に即した内容にしてください

【回答形式】
- 各要素のtypeは必ず"belief_selection"を指定してください
- descriptionは10字以内で簡潔に記述してください
- 最初の5つは内的要因、後の5つは外的要因を記述してください
- 内的要因と外的要因が明確に区別できる表現を使用してください

{format_instructions}
"""

belief_explanation_template = """あなたは人間の行動と失敗の分析の専門家です。
ユーザーが入力した失敗事例とその詳細に基づき、以下の質問に短く答えて、失敗の原因を7つの異なる視点から具体的な事実で説明してください。
その際、出力結果をもとにユーザーが後続の文章を補完できるよう、状況を細分化した具体的な要素候補を提示するようにしてください。
例えば、入力が「会議で提案が却下された」の場合は、「提案内容」「発言のタイミング」「参加者の反応」などの要素が考えられる。
入力は上記の例に限らず、一般的な失敗の原因に対する質問に答える形で出力してください。
回答は後述のPydanticスキーマに従い、JSON形式で出力してください。
推測や主観的な解釈は避け、客観的な事実に基づく記述に徹してください。
出力は敬語を使わず、平易で直接的な表現にしてください。

【失敗事例】
{text}

【失敗の詳細】
{adversity}

【失敗の原因】
{selected_label}

【質問】
1. どの行動が直接の原因となったか？具体的に記せ。
2. 自分の判断のどの点が影響したか？記せ。
3. 他者の行動で、問題となった要素は何か？記せ。
4. 環境や設備など外部要因の影響はどこにあるか？記せ。
5. 期待された結果との差はどこにあったか？記せ。
6. 時系列的な変化が影響したか？記せ。
7. 状況変化に対する対応の違いは何か？記せ。

【回答形式】
- 各要素のtypeは必ず"belief_explanation"を指定してください。
- descriptionは15字以内で具体的に記述してください。

{format_instructions}
"""



dispute_evidence_template = """あなたは人間の行動と失敗の分析の専門家です。
以下の失敗事例とその詳細、失敗の原因を踏まえ、この失敗の原因が重要であることを支持する根拠を、以下の5つの質問から生成してください。
回答は後述のPydanticスキーマに従い、JSON形式で出力してください。
推測や創作は最小限に抑えてください。
出力は敬語を使わず、平易で直接的な表現にしてください。

【失敗事例】
{text}

【失敗の詳細】
{adversity}

【原因】
{selected_label}

【質問】
1. 【原因】が【失敗事例】の他の要因と比べた際に、重要であるとされる観察証拠は何か？
2. 【原因】がもつ【失敗事例】のシステム・構造的関連性は何か？
3. 【原因】解決で【失敗事例】の再発防止となる根拠は何か？
4. 【原因】は【失敗事例】の連鎖上どの点でレバレッジか？
5. 【原因】は【失敗事例】の組織・技術的根本問題とどのような関連性があるか？

【回答形式】
- 各要素のtypeは必ず"dispute_evidence"を指定してください。
- 根拠は必ず【原因】＋【原因を支持する根拠】として記述し、【失敗事例】は含めないこと。
-【原因を支持する根拠】の具体化を最重要視してください。
- 質問にある文言をそのまま使用するのは避け、質問の内容を踏まえて【原因を支持する根拠】を具体的に記述してください。
- 5つの根拠はそれぞれ50字以内で簡潔に記述してください。
- 各根拠の語尾は必ず「ので」で終わるようにしてください。

{format_instructions}
"""


dispute_counter_template = """あなたは人間の行動と失敗の分析の専門家です。
以下の失敗事例とその詳細、失敗の原因および根拠を踏まえ、この原因に対する反証可能性を、以下の5つの質問から生成してください。
回答は後述のPydanticスキーマに従い、JSON形式で出力してください。
推測や創作は最小限に抑えてください。
出力は敬語を使わず、平易で直接的な表現にしてください。

【失敗事例】
{text}

【失敗の詳細】
{adversity}

【失敗の原因】
{selected_label}

【原因を支持する根拠】
{dispute_evidence}

【質問】
1. 【原因】と根拠から、見落とされた証拠は何か？（例：「【原因】は○○であるため、証拠が別に存在する可能性」）
2. 【原因】と根拠から、システム・構造的関連が反映されていない点は何か？（例：「【原因】は○○であるため、関連性が薄い可能性」）
3. 【原因】と根拠、及び【失敗の詳細】から、再発防止につながらない点は何か？（例：「【原因】は○○であるため、効果が小さい可能性」）
4. 【原因】と根拠から、組織・技術的な問題が不明瞭な点は何か？（例：「【原因】は○○であるため、根拠が弱い可能性」）
5. 【原因】と根拠から、他の要因で説明可能な部分は何か？（例：「【原因】は○○であるため、〜のような説明も可能である」)

【回答形式】
- 各要素のtypeは必ず"dispute_counter"を指定してください。
- 反証可能性は【質問】に対し、客観的に判断して記述してください。
- 【原因】は○○であるためという表現を必ず含めてください。
- 5つの反証可能性は互いに異なる視点で記述してください。
- 各反証は60字以内で簡潔に記述してください。
- 「他の要因」などといった抽象的/一般的な表現は絶対に避け、具体的な事実を記述してください。

{format_instructions}
"""



explain_template = """
以下に, ユーザーの失敗事例と偉人の失敗事例があります。ユーザーの失敗事例が偉人の失敗事例とどのように似ているかを簡潔に返答してください。

【ユーザーの失敗事例】
{user_failure}

【偉人の失敗事例】
{hero_failure}

【回答形式】
- 2つの文章の類似点のみを簡潔に返答してください
- 回答は1文で簡潔に記述してください
- 回答は敬語を使わず、平易で直接的な表現にしてください

"""

summarize_failure_template = """
以下に, ユーザーが簡潔に記述した失敗事例とその詳細があります。失敗事例の詳細を読みやすく分かりやすい文章として200字程度で要約してください。

【ユーザーが簡潔に記述した失敗事例】
{failure_text}

【失敗の詳細】
{adversity}

【回答形式】
- 失敗事例の詳細を読みやすく分かりやすい文章として再構成してください
- 各要素の本質的な内容を損なわないように注意してください
- 単なる箇条書きの言い換えは避け、要素間の関係性や文脈が分かるように記述してください

"""

summarize_reason_template = """
以下に, 失敗事例の原因に関する説明と根拠があります。失敗事例の原因に関する説明と根拠を読みやすく分かりやすい文章として200字程度で要約してください。

【原因ラベル】
{selected_label}

【原因に関する説明】
{belief_explanation}

【根拠】
{dispute_evidence}

【反対の視点】
{dispute_counter}

【回答形式】
- 失敗事例の原因に関する説明と根拠を読みやすく分かりやすい文章として再構成してください
- 各要素の本質的な内容を損なわないように注意してください
- 単なる箇条書きの言い換えは避け、要素間の関係性や文脈が分かるように記述してください

"""

summarize_all_template = """
以下に, 失敗事例の詳細と原因に関する説明があります。失敗事例の詳細と原因に関する説明を読みやすく分かりやすい文章として100字程度で要約してください。
詳細と原因以外には触れないでください。

【失敗事例の詳細】
{summarized_failure}

【原因に関する説明】
{summarized_reason}

"""
